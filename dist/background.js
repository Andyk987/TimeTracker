(()=>{"use strict";var e=function(e,t,s,i){return new(s||(s=Promise))((function(n,o){function c(e){try{h(i.next(e))}catch(e){o(e)}}function r(e){try{h(i.throw(e))}catch(e){o(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(c,r)}h((i=i.apply(e,t||[])).next())}))};console.log("Hello from background script!");const t="www.youtube.com/watch?",s=new class{constructor(){this.chrome=chrome,this.checkingUrl=t,this.isChecking=!1,this.timerId=void 0,this.time=0,this.timeStamp=[]}getMessage(){return e(this,void 0,void 0,(function*(){yield this.chrome.runtime.onMessage.addListener(((e,t,s)=>{if(!e.hasOwnProperty("code"))return;const{code:i}=this.handleMessage(e);s(i)}))}))}sendMessage(t,s){return e(this,void 0,void 0,(function*(){yield this.chrome.tabs.query({active:!0},(e=>{this.chrome.tabs.sendMessage(t,s,(e=>{console.log(e,"success")}))}))}))}handleMessage(e){switch(e.code){case"START_CHECKING":return this.isChecking=!0,{code:"START_CHECKING_SUCCEESS"};case"STOP_CHECKING":return this.isChecking=!1,{code:"STOP_CHECKING_SUCCEESS"}}}detectUrlChange(e){this.chrome.tabs.onUpdated.addListener(((e,s,i)=>{"complete"===s.status&&i.url.includes(t)&&(console.log(i,"tab-"),this.startChecking())}))}getAllWindows(){this.chrome.windows.getAll((e=>{e&&e.forEach((e=>{var t;null===(t=e.tabs)||void 0===t||t.forEach((e=>{}))}))}))}startChecking(){return e(this,void 0,void 0,(function*(){try{yield new Promise(((e,t)=>{this.timerId=setInterval((()=>{this.time++,console.log(this.time)}),1e3),e()}))}catch(e){console.log(e,"err occ")}}))}stopChecking(){const e=this.timerId;if(console.log(e,"id"),!e)return this.chrome.runtime.sendMessage({code:"STOP_CHECKING_ERROR"});clearInterval(e),this.timerId=void 0}};chrome.runtime.onInstalled.addListener((e=>{const t=chrome.runtime.getManifest();chrome.tabs.query({url:t.content_scripts[0].matches},(e=>{e.forEach(((t,s)=>{var i;chrome.scripting.executeScript({target:{tabId:null===(i=e[s])||void 0===i?void 0:i.id},files:["content.js"]})}))}))})),s.getMessage(),s.detectUrlChange(!1)})();